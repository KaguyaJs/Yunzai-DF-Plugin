import t from"../config/index.js";export function ReplaceMessage(e,r){let i=[];if(e.hasAlias&&e.isGroup){const r=t.getGroup(String(e.group_id),String(e.self_id));i=Array.isArray(r.botAlias)?r.botAlias:[r.botAlias]}return e.message.filter(t=>"at"!==t.type).map(t=>({...t})).filter(t=>{if("text"===t.type){if(r&&t.text&&(t.text=t.text.replace(r,"").trim()),!t.text)return!1;for(const e of i)if(t.text.startsWith(e)){t.text=t.text.slice(e.length).trim();break}}else"url"in t&&t.url&&(t.file=t.url);return!0})}export async function getSourceMessage(t){return t.getReply?await t.getReply():t.source?t.isGroup?(await t.group.getChatHistory(t.source.seq,1)).pop()||null:(await t.friend.getChatHistory(t.source.time,1)).pop()||null:null}export function extractMessageId(t){const e=t.match(/\(([^)]+)\)/);return e?e[1]:null}